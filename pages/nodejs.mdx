# Node.js SDK

This SDK allows you to interact with UTxORPC compatible nodes, enabling operations such as fetching blocks, submitting transactions, and syncing with the latest blocks.

## Prerequisites

Before you begin, ensure you have the following installed:

- **Node.js**: Version 20.0 or higher.
- **npm**: The Node.js package manager.

## Installation

To install the UTxORPC Node.js SDK in your project, use the following command:

```bash
npm install @utxorpc/sdk --save
```

## Overview

The SDK provides three primary clients for interacting with UTxORPC:

1. **CardanoSyncClient**: Provides an interface for synchronizing chain data, fetching blocks, and tracking the tip of the blockchain.
2. **CardanoQueryClient**: Provides an interface for submitting transactions and monitoring their progress through various stages in their lifecycle.
3. **CardanoSubmitClient**: Provides an interface for querying the state of the ledger with the main goal of constructing new transactions.

## Usage

Below are examples of how to use each of the clients in the SDK.

### 1. CardanoSyncClient

The `CardanoSyncClient` allows you to synchronize with the blockchain, follow the tip, and fetch specific blocks.

#### Example: Following the Tip

```javascript
import { CardanoSyncClient } from "@utxorpc/sdk";

async function followTipExample() {
  const syncClient = new CardanoSyncClient({
    uri: "https://preview.utxorpc-v0.demeter.run",
    headers: {
      "dmtr-api-key": "dmtr_utxorpc1vc0m93rynmltysttwm7ns9m3n5cklws6"
    }
  });

  const tip = syncClient.followTip([
    { 
        slot: 54131816, 
        hash: "34c65aba4b299113a488b74e2efe3a3dd272d25b470d25f374b2c693d4386535" 
    },
  ]);

  for await (const event of tip) {
    console.log(event);
  }
}

followTipExample().catch(console.error);
```

#### Example: Fetching a Block

```javascript
import { CardanoSyncClient } from "@utxorpc/sdk";

async function fetchBlockExample() {
  const syncClient = new CardanoSyncClient({
    uri: "https://preview.utxorpc-v0.demeter.run",
    headers: {
      "dmtr-api-key": "dmtr_utxorpc1vc0m93rynmltysttwm7ns9m3n5cklws6"
    }
  });

  const block = await syncClient.fetchBlock({
    slot: 54131816,
    hash: "34c65aba4b299113a488b74e2efe3a3dd272d25b470d25f374b2c693d4386535",
  });

  console.log(block);
}

fetchBlockExample().catch(console.error);
```

### 2. CardanoQueryClient

The `CardanoQueryClient` allows you to query blockchain data, including reading protocol parameters and searching UTXOs.

#### Example: Reading Blockchain Parameters

```javascript
import { CardanoQueryClient } from "@utxorpc/sdk";

async function readParamsExample() {
  const queryClient = new CardanoQueryClient({
    uri: "https://preview.utxorpc-v0.demeter.run",
    headers: {
      "dmtr-api-key": "dmtr_utxorpc1vc0m93rynmltysttwm7ns9m3n5cklws6"
    }
  });

  const params = await queryClient.readParams();
  console.log(params);
}

readParamsExample().catch(console.error);
```

#### Example: Searching UTXOs by Address

```javascript
import { CardanoQueryClient } from "@utxorpc/sdk";

async function searchUtxosByAddressExample() {
  const queryClient = new CardanoQueryClient({
    uri: "https://preview.utxorpc-v0.demeter.run",
    headers: {
      "dmtr-api-key": "dmtr_utxorpc1vc0m93rynmltysttwm7ns9m3n5cklws6"
    }
  });

  const utxos = await queryClient.searchUtxosByAddress(
    Buffer.from("705c87cbca3a88cbfee6f6ad820acea99f484b4830fc632610f2a30146", "hex")
  );

  utxos.forEach((utxo) => {
    console.log(utxo);
  });
}

searchUtxosByAddressExample().catch(console.error);
```

### 3. CardanoSubmitClient

The `CardanoSubmitClient` is used to submit transactions to the blockchain.

#### Example: Submitting a Transaction

```javascript
import { CardanoSubmitClient } from "@utxorpc/sdk";

async function submitTxExample() {
  const submitClient = new CardanoSubmitClient({
    uri: "https://preview.utxorpc-v0.demeter.run",
    headers: {
      "dmtr-api-key": "dmtr_utxorpc1vc0m93rynmltysttwm7ns9m3n5cklws6"
    }
  });

  const txSample = "84a30081825820639b4af1e7bf25edd5d9dfb63ea79827a25e15b2ecf2bc861eeeeead0279108901018282583900e63022b0f461602484968bb10fd8f872787b862ace2d7e943292a37003ec6a12860ef8c07d4c1a8de7df06acb0f0330a6087ecbe972082a71a00766272825839004693c0ac525d045cb0a4e75bd3adbd6956b3b744e88d21e041fc9b630df092006419e469e0c77876a499124bf903735b434c7989f7a8090a1b000000025208a690021a00029075a10081825820e6e75c7876c610afd28a19c2947e72c1a629ab7903283e14915badee7c55402e5840b5d23d73a2c52515862310b08c94d51c6a0ccc2a6d61008d67070317a4dff6e0e41ae62423852007bfa6778162296362c0a1f951ad7634706a1ac6922085b602f5f6";
  const txHash = await submitClient.submitTx(Buffer.from(txSample, "hex"));

  const txHashHex = Buffer.from(txHash).toString("hex");
  console.log(txHashHex);
}

submitTxExample().catch(console.error);
```

## Conclusion

This SDK is designed to streamline the process of interacting with UTxORPC using Node.js. Whether you're syncing with the latest blockchain data, querying UTXOs, or submitting transactions, this SDK provides the necessary tools to build robust blockchain applications with ease.
